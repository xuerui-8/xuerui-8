# Unibox路由器任意文件读取漏洞检测工具

## 工具介绍
本工具用于检测Unibox路由器的`download_csv.php`接口是否存在任意文件读取漏洞。该漏洞可能允许攻击者通过构造特定请求，读取服务器上的敏感文件（如`/etc/passwd`），从而获取系统信息并进一步渗透。


## 漏洞原理
Unibox路由器的`/tools/download_csv.php`接口存在路径遍历漏洞，攻击者可通过在请求中注入相对路径（如`../../../etc/passwd`），读取服务器上的任意文件。本工具通过发送特定构造的请求，检测目标是否存在该漏洞。


## 工具功能
- 单URL检测：对单个目标URL进行漏洞检测
- 批量检测：通过文件导入多个URL，批量检测漏洞
- 自动记录：将存在漏洞的目标自动保存到`result.txt`文件中


## 使用环境
- Python 3.x
- 依赖库：`requests`

安装依赖：
```bash
pip install requests
```


## 使用方法
1. **单URL检测**  
   对单个目标URL进行漏洞检测：
   ```bash
   python poc.py -u http://target-ip
   ```

2. **批量检测**  
   从文件中读取多个URL进行批量检测（文件中每行一个URL）：
   ```bash
   python poc.py -f urls.txt
   ```

3. **查看帮助**  
   查看工具使用说明：
   ```bash
   python poc.py -h
   ```


## 输出说明
- `[+] http://target-ip 存在任意文件读取漏洞`：目标存在漏洞，结果会写入`result.txt`
- `[-] http://target-ip 不存在任意文件读取`：目标不存在漏洞
- `[*] http://target-ip 访问有问题，请手工检查`：目标访问异常（如网络不通、状态码非200等）


## 注意事项
1. 本工具仅用于合法授权的安全测试，未经授权使用可能违反法律法规
2. 检测时需确保目标URL格式正确（如包含`http://`或`https://`）
3. 批量检测时，建议控制线程数量（默认100线程，可在代码中修改`Pool(100)`调整）
4. 部分目标可能存在WAF拦截，结果仅供参考


## 免责声明
本工具仅用于网络安全学习和授权测试，使用者需遵守《网络安全法》等相关法律法规。对于未经授权使用本工具造成的一切后果，使用者自行承担责任。
