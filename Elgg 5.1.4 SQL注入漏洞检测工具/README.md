# Elgg 5.1.4 SQL注入漏洞检测工具

## 工具介绍
本工具用于检测Elgg 5.1.4版本是否存在SQL注入漏洞。该漏洞源于目标系统对用户输入的参数过滤不严格，攻击者可通过构造特殊请求注入恶意SQL代码，导致数据库信息泄露、数据篡改等风险。工具通过发送包含延时函数的请求，对比正常请求与注入请求的响应时间差，判断漏洞是否存在。


## 漏洞背景
Elgg是一款开源的社交网络引擎，用于构建社交网站、社区平台等。其5.1.4版本的`/members`接口在处理排序参数时存在SQL注入漏洞，攻击者可利用该漏洞执行任意SQL语句，包括延时函数（如`sleep(6)`），通过响应时间差异判断漏洞存在性。


## 依赖安装
工具基于Python开发，需依赖`requests`库，安装命令如下：
```bash
pip install requests
```


## 使用方法
### 命令参数说明
- `-u` / `--url`：指定单个目标URL进行检测（例如：`http://example.com`）
- `-f` / `--file`：指定包含多个目标URL的文件路径（文件中每行一个URL）
- `-h`：查看帮助信息


### 单目标检测
```bash
python 脚本名称.py -u http://目标地址
```
示例：
```bash
python elgg_sqli_check.py -u http://192.168.1.100:8080
```


### 批量检测
```bash
python 脚本名称.py -f 目标URL文件路径
```
示例（假设URL列表保存在`urls.txt`中）：
```bash
python elgg_sqli_check.py -f urls.txt
```


## 检测原理
1. 工具向目标发送**正常请求**，记录响应时间（`res1_time`）。
2. 向目标发送包含漏洞检测`payload`的请求（`payload`中包含`sleep(6)`延时函数），记录响应时间（`res2_time`）。
3. 对比两者的响应时间差：若`res2_time - res1_time ≥ 5秒`，则判定目标存在SQL注入漏洞（因延时函数被执行）。
4. 检测结果会输出到控制台，并将存在漏洞的目标URL记录到`result1.txt`文件中。


## 结果说明
- `[+] 目标URL 存在SQL注入漏洞`：目标响应时间差符合预期，存在漏洞。
- `[-] 目标URL 不存在SQL注入漏洞`：响应时间差不足，未检测到漏洞。
- `[*] 目标URL 响应状态码非200，请手工测试`：目标无法正常访问（状态码不是200），需手动验证。
- `[!] 目标URL 请求异常：错误信息`：请求过程中发生异常（如超时、网络错误等）。


## 注意事项
1. 本工具仅用于合法授权的安全测试与研究，禁止用于未授权的攻击行为，使用前请确保遵守《网络安全法》等相关法律法规。
2. 批量检测时，默认并发数为50，可根据网络环境修改代码中`Pool(50)`的数值调整并发量（过高可能导致目标服务器拒绝服务或本地网络拥堵）。
3. 工具运行时会禁用SSL证书验证（`verify=False`），若目标环境对SSL验证要求严格，可能需要删除该参数并确保本地信任目标证书。
4. 网络波动可能影响响应时间判断，建议对检测结果进行人工复核。


## 免责声明
使用本工具造成的任何直接或间接损失，由使用者自行承担，作者不承担任何责任。
