Vite vite-project 接口任意文件读取漏洞（CNNVD-202504-684）POC 工具 README
1. 工具概述
本工具用于检测 Vite 构建工具相关项目 是否存在编号为 CNNVD-202504-684 的任意文件读取漏洞。该漏洞源于 Vite 项目中 vite-project 接口对路径校验不严格，攻击者可通过构造目录穿越 payload 读取目标服务器上的敏感文件（如 /etc/passwd），导致服务器信息泄露，甚至为后续攻击提供条件。

工具支持 单 URL 检测 和 批量 URL 检测 两种模式，采用多线程（默认 50 线程）提升批量检测效率，同时自动将存在漏洞的目标保存至结果文件，便于后续分析与处置。
2. 漏洞信息
项目	描述
漏洞编号	CNNVD-202504-684
漏洞名称	Vite vite-project 接口任意文件读取漏洞
漏洞类型	任意文件读取（目录穿越）
风险等级	中高危（未授权访问敏感文件，可能泄露服务器配置、用户数据等关键信息）
影响范围	使用 Vite 构建且包含 vite-project 接口的相关项目（具体受影响版本需参考官方公告）
漏洞原理	漏洞接口未对用户输入的路径进行严格过滤，攻击者通过 ../../../../../ 等目录穿越字符，可绕过路径限制，访问服务器任意可读文件（本工具默认检测 /etc/passwd 以验证漏洞存在性）。
3. 环境依赖
3.1 运行环境
Python 3.6 及以上版本（推荐 Python 3.8+，确保兼容性）
支持 Windows、Linux、macOS 等主流操作系统
3.2 依赖库
工具依赖 Python 第三方库 requests，需提前安装（其他依赖如 argparse、multiprocessing 为 Python 标准库，无需额外安装）：

bash
pip install requests
4. 工具使用说明
4.1 命令格式
工具通过命令行参数指定检测模式，基础使用格式如下：

bash
python [工具文件名].py [参数]
4.2 参数说明
参数	简写	功能描述
--url	-u	单 URL 检测，指定待检测的目标 URL（例如：http://192.168.1.100:3000）
--file	-f	批量检测，指定包含多个 URL 的文本文件路径（文件需按 “每行一个 URL” 格式编写）
--help	-h	查看工具帮助信息，显示参数说明及使用示例
4.3 关键注意点（修复代码逻辑问题）
原代码存在单 URL 检测逻辑缺失问题：当使用 -u 参数指定单 URL 时，仅打印 URL 但未调用 poc() 函数执行检测。若需正常使用单 URL 检测功能，需先修改 main() 函数中对应代码，修复后如下：

python
运行
if args.url and not args.file:
    poc(args.url)  # 原代码为 print(args.url)，需替换为调用poc函数
4.4 使用示例
示例 1：单 URL 检测
检测单个目标是否存在任意文件读取漏洞：

bash
python vite-cnnvd-202504-684-poc.py -u http://192.168.1.100:3000
示例 2：批量 URL 检测
从 urls.txt 文件中读取多个目标 URL，批量执行检测（默认 50 线程）：

bash
python vite-cnnvd-202504-684-poc.py -f urls.txt

urls.txt 文件格式要求：每行一个目标 URL，需包含协议（http/https）和端口（若非默认端口），示例如下：
plaintext
http://192.168.1.100:3000
https://test.example.com
http://10.0.0.5:8080

5. 结果说明
5.1 控制台输出
工具运行时实时在控制台输出检测结果，不同前缀代表不同状态：

[+] [URL] 存在任意文件读取：目标存在漏洞，已自动写入结果文件
[-] 该[URL]不存在任意文件读取：目标访问正常，但未检测到漏洞
[*] 该[URL]存在问题,请手工测试：目标 HTTP 状态码非 200（如 404、500 等），需手动确认访问性
无输出：目标访问超时、连接拒绝或发生其他异常（已通过 try-except 捕获，不影响批量检测流程）
5.2 结果文件
工具会在当前运行目录自动生成 result1.txt 文件，仅保存存在漏洞的目标 URL（每行一个）
多次运行工具时，结果会追加到文件末尾（不会覆盖历史数据，如需清空需手动删除该文件）
6. 注意事项
合法性声明
本工具仅用于 合法授权的渗透测试、漏洞验证场景，严禁用于未授权的攻击行为。
使用前必须获得目标系统的书面授权，因未授权使用导致的法律责任、财产损失等，均由使用者自行承担。
检测逻辑说明
工具通过请求 目标URL + /@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&?inline=1.wasm?init 检测漏洞，核心判断条件为响应中是否包含 base64 字符串（敏感文件内容可能以 Base64 编码返回）。
若目标服务器为 Windows 系统，可修改 payload 中的 /etc/passwd 为 Windows 敏感文件路径（如 C:/Windows/System32/drivers/etc/hosts），以适配不同操作系统检测需求。
线程调整建议
批量检测默认使用 50 线程，若目标数量过多（如超过 1000 个）或网络带宽有限，可修改代码中 Pool(50) 为更小数值（如 Pool(20)），避免触发目标服务器或防护设备（如 WAF、防火墙）的限流 / 拦截机制。
误判与漏判处理
若目标存在漏洞但响应中未包含 base64 字符串，可能导致漏判，建议对 [*] 状态的目标进行手工复核。
若目标服务器自定义了 404 页面且包含 base64 字符串，可能导致误判，需结合响应内容进一步验证（如查看是否包含 /etc/passwd 的特征内容）。
7. 漏洞修复建议
官方修复：及时关注 Vite 官方更新，升级至已修复该漏洞的版本（参考 Vite 官方 GitHub 仓库或安全公告）。
临时防护：
若无法立即升级，可通过 Web 服务器（Nginx、Apache）或 WAF 配置规则，拦截包含 ../、@fs 等特征的恶意请求，禁止访问 vite-project 相关敏感接口。
限制服务器文件访问权限，避免 Web 服务进程拥有读取 /etc/passwd、/etc/shadow 等敏感文件的权限。
代码层面：在 Vite 项目中对 vite-project 接口的输入路径进行严格校验，过滤目录穿越字符（如 ../），确保仅允许访问指定目录下的文件。
